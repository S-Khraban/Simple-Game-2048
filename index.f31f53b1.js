function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var e=/*#__PURE__*/function(){var e;function r(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.size=4,this._initial=Array.isArray(t)&&t.length===this.size?t.map(function(t){return t.slice()}):this._emptyBoard(),this._board=this._initial.map(function(t){return t.slice()}),this._score=0,this._status="idle"}return e=[{key:"getState",value:function(){return this._board.map(function(t){return t.slice()})}},{key:"getScore",value:function(){return this._score}},{key:"getStatus",value:function(){return this._status}},{key:"start",value:function(){"idle"===this._status&&(this._isBoardEmpty()&&(this._spawnRandomTile(),this._spawnRandomTile()),this._status="playing",this._recomputeStatus())}},{key:"restart",value:function(){this._board=this._initial.map(function(t){return t.slice()}),this._score=0,this._status="idle"}},{key:"moveLeft",value:function(){this._move("left")}},{key:"moveRight",value:function(){this._move("right")}},{key:"moveUp",value:function(){this._move("up")}},{key:"moveDown",value:function(){this._move("down")}},{key:"_emptyBoard",value:function(){var t=this;return Array.from({length:this.size},function(){return Array(t.size).fill(0)})}},{key:"_isBoardEmpty",value:function(){return this._board.every(function(t){return t.every(function(t){return 0===t})})}},{key:"_spawnRandomTile",value:function(){for(var e,r=[],n=0;n<this.size;n++)for(var i=0;i<this.size;i++)0===this._board[n][i]&&r.push([n,i]);if(!r.length)return!1;var o=function(t){if(Array.isArray(t))return t}(e=r[Math.floor(Math.random()*r.length)])||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(t);!(s=(r=i.next()).done)&&(o.push(r.value),2!==o.length);s=!0);}catch(t){a=!0,n=t}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,2)||function(e,r){if(e){if("string"==typeof e)return t(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,2)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=o[0],a=o[1];return this._board[s][a]=.9>Math.random()?2:4,!0}},{key:"_move",value:function(t){if("playing"===this._status){var e=this._serialize(this._board),r=!1;"left"===t?r=this._moveLeftInternal():"right"===t?(this._reverseRows(),r=this._moveLeftInternal(),this._reverseRows()):"up"===t?(this._transpose(),r=this._moveLeftInternal(),this._transpose()):"down"===t&&(this._transpose(),this._reverseRows(),r=this._moveLeftInternal(),this._reverseRows(),this._transpose()),r&&e!==this._serialize(this._board)&&(this._spawnRandomTile(),this._recomputeStatus())}}},{key:"_serialize",value:function(t){return t.flat().join(",")}},{key:"_reverseRows",value:function(){for(var t=0;t<this.size;t++)this._board[t].reverse()}},{key:"_transpose",value:function(){for(var t=this.size,e=0;e<t;e++)for(var r=e+1;r<t;r++){var n=this._board[e][r];this._board[e][r]=this._board[r][e],this._board[r][e]=n}}},{key:"_moveLeftInternal",value:function(){for(var t=this,e=!1,r=0;r<this.size;r++)!function(r){for(var n=t._board[r].slice().filter(function(t){return 0!==t}),i=[],o=0;o<n.length;o++)if(n[o]===n[o+1]){var s=2*n[o];i.push(s),t._score+=s,o++}else i.push(n[o]);for(;i.length<t.size;)i.push(0);for(var a=0;a<t.size;a++)t._board[r][a]!==i[a]&&(e=!0),t._board[r][a]=i[a]}(r);return e}},{key:"_has2048",value:function(){return this._board.some(function(t){return t.some(function(t){return 2048===t})})}},{key:"_canMove",value:function(){if(this._board.some(function(t){return t.some(function(t){return 0===t})}))return!0;for(var t=this.size,e=0;e<t;e++)for(var r=0;r<t;r++){var n=this._board[e][r];if(r+1<t&&n===this._board[e][r+1]||e+1<t&&n===this._board[e+1][r])return!0}return!1}},{key:"_recomputeStatus",value:function(){if(this._has2048()){this._status="win";return}if(!this._canMove()){this._status="lose";return}this._status="playing"}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(r.prototype,e),r}();"undefined"!=typeof module&&module.exports&&(module.exports=e),"undefined"!=typeof window&&(window.Game=e);
//# sourceMappingURL=index.f31f53b1.js.map
