{"mappings":"A,S,E,C,C,C,E,C,A,M,G,E,E,M,A,G,C,E,E,M,A,E,I,I,E,E,E,A,M,G,E,E,I,C,C,E,C,C,C,E,C,O,C,CCEA,IAAM,EAAA,WAAA,EAAN,e,EAAM,SAAA,EACQ,CAAY,GADpB,A,S,C,C,C,E,G,C,C,a,C,E,M,A,U,oC,EAAA,IAAA,CAAA,GAEF,IAAI,CAAC,IAAI,CAAG,EAEZ,IAAI,CAAC,QAAQ,CACX,MAAM,OAAO,CAAC,IAAiB,EAAa,MAAM,GAAK,IAAI,CAAC,IAAI,CAC5D,EAAa,GAAG,CAAC,SAAC,CAFxB,EAEgC,OAAA,EAAI,KAAK,EACnC,GAAA,IAAI,CAAC,WAAW,GAEtB,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAC,CAAjC,EAAyC,OAAA,EAAI,KAAK,E,GAClD,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,OAAO,CAAG,M,CAXb,O,EAAA,C,CAcJ,IAAA,WAAA,MAAA,WACE,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,SAAC,CAAxB,EAA8B,OAAA,EAAE,KAAK,E,EACvC,C,E,CAEA,IAAA,WAAA,MAAA,WACE,OAAO,IAAI,CAAC,MAAM,AACpB,C,E,CAEA,IAAA,YAAA,MAAA,WACE,OAAO,IAAI,CAAC,OAAO,AACrB,C,E,CAEA,IAAA,QAAA,MAAA,WACuB,SAAjB,IAAI,CAAC,OAAO,GAIZ,IAAI,CAAC,aAAa,KACpB,IAAI,CAAC,gBAAgB,GACrB,IAAI,CAAC,gBAAgB,IAEvB,IAAI,CAAC,OAAO,CAAG,UACf,IAAI,CAAC,gBAAgB,GACvB,C,E,CAEA,IAAA,UAAA,MAAA,WACE,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAC,CAAjC,EAAyC,OAAA,EAAI,KAAK,E,GAClD,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,OAAO,CAAG,MACjB,C,E,CAEA,IAAA,WAAA,MAAA,WACE,IAAI,CAAC,KAAK,CAAC,OACb,C,E,CACA,IAAA,YAAA,MAAA,WACE,IAAI,CAAC,KAAK,CAAC,QACb,C,E,CACA,IAAA,SAAA,MAAA,WACE,IAAI,CAAC,KAAK,CAAC,KACb,C,E,CACA,IAAA,WAAA,MAAA,WACE,IAAI,CAAC,KAAK,CAAC,OACb,C,E,CAEA,IAAA,cAAA,MAAA,W,I,E,I,CACE,OAAO,MAAM,IAAI,CAAC,CAAE,OAAQ,IAAI,CAAC,IAAI,AAAC,EAAG,WAAM,OAAA,MAAM,EAAK,IAAI,EAAE,IAAI,CAAC,E,EACvE,C,E,CAEA,IAAA,gBAAA,MAAA,WACE,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,SAAC,CAA1B,EAAkC,OAAA,EAAI,KAAK,CAAC,SAAC,CAAX,EAAiB,OAAA,AAAM,IAAN,C,E,EACrD,C,E,CAEA,IAAA,mBAAA,MAAA,WAGE,IAAK,I,EAFC,EAAU,EAAE,CAET,EAAK,EAAG,EAAK,IAAI,CAAC,IAAI,CAAE,IAC/B,IAAK,IAAI,EAAK,EAAG,EAAK,IAAI,CAAC,IAAI,CAAE,IACH,IAAxB,IAAI,CAAC,MAAM,CAAC,EAAG,CAAC,EAAG,EACrB,EAAQ,IAAI,CAAC,CAAC,EAAI,EAAG,EAK3B,GAAI,CAAC,EAAQ,MAAM,CACjB,MAAO,CAAA,EAGT,IAAiB,E,A,S,C,E,G,M,O,C,G,O,C,E,EAAA,CAAO,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,GAAK,EAAQ,MAAM,EAAE,G,A,S,C,C,C,E,I,E,E,E,A,M,E,K,A,a,O,Q,C,C,O,Q,C,E,C,C,a,C,G,A,M,G,I,E,E,C,E,C,E,E,C,E,G,C,I,E,E,I,C,G,C,C,E,A,C,E,E,I,E,E,I,A,I,E,I,C,E,K,E,AAAA,I,E,M,E,E,C,G,C,M,E,C,E,C,E,E,C,Q,C,G,C,G,A,M,E,M,E,E,M,E,Q,C,G,E,M,C,C,C,O,E,E,EAAA,I,A,S,C,C,C,E,G,G,G,A,U,O,E,O,E,EAAA,G,I,E,O,S,C,Q,C,I,C,G,K,C,E,I,G,W,G,E,W,E,C,E,E,W,C,I,A,E,A,Q,G,A,Q,E,O,M,I,C,G,G,A,c,G,2C,I,C,G,O,E,EAAA,G,E,EAAA,I,A,W,M,A,U,6I,IAA7D,EAAU,CAAA,CAAA,EAAA,CAAN,EAAM,CAAjB,CAAA,EAAA,CAIA,OAFA,IAA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","sources":["<anon>","src/modules/Game.class.js"],"sourcesContent":["\"use strict\";\nfunction _array_like_to_array(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];\n    return arr2;\n}\nfunction _array_with_holes(arr) {\n    if (Array.isArray(arr)) return arr;\n}\nfunction _class_call_check(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n        throw new TypeError(\"Cannot call a class as a function\");\n    }\n}\nfunction _defineProperties(target, props) {\n    for(var i = 0; i < props.length; i++){\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n    }\n}\nfunction _create_class(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n}\nfunction _iterable_to_array_limit(arr, i) {\n    var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n    if (_i == null) return;\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _s, _e;\n    try {\n        for(_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true){\n            _arr.push(_s.value);\n            if (i && _arr.length === i) break;\n        }\n    } catch (err) {\n        _d = true;\n        _e = err;\n    } finally{\n        try {\n            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n        } finally{\n            if (_d) throw _e;\n        }\n    }\n    return _arr;\n}\nfunction _non_iterable_rest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _sliced_to_array(arr, i) {\n    return _array_with_holes(arr) || _iterable_to_array_limit(arr, i) || _unsupported_iterable_to_array(arr, i) || _non_iterable_rest();\n}\nfunction _unsupported_iterable_to_array(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _array_like_to_array(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(n);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _array_like_to_array(o, minLen);\n}\nvar Game = /*#__PURE__*/ function() {\n    function Game(initialState) {\n        _class_call_check(this, Game);\n        this.size = 4;\n        this._initial = Array.isArray(initialState) && initialState.length === this.size ? initialState.map(function(row) {\n            return row.slice();\n        }) : this._emptyBoard();\n        this._board = this._initial.map(function(row) {\n            return row.slice();\n        });\n        this._score = 0;\n        this._status = \"idle\";\n    }\n    _create_class(Game, [\n        {\n            key: \"getState\",\n            value: function getState() {\n                return this._board.map(function(r) {\n                    return r.slice();\n                });\n            }\n        },\n        {\n            key: \"getScore\",\n            value: function getScore() {\n                return this._score;\n            }\n        },\n        {\n            key: \"getStatus\",\n            value: function getStatus() {\n                return this._status;\n            }\n        },\n        {\n            key: \"start\",\n            value: function start() {\n                if (this._status !== \"idle\") return;\n                if (this._isBoardEmpty()) {\n                    this._spawnRandomTile();\n                    this._spawnRandomTile();\n                }\n                this._status = \"playing\";\n                this._recomputeStatus();\n            }\n        },\n        {\n            key: \"restart\",\n            value: function restart() {\n                this._board = this._initial.map(function(row) {\n                    return row.slice();\n                });\n                this._score = 0;\n                this._status = \"idle\";\n            }\n        },\n        {\n            key: \"moveLeft\",\n            value: function moveLeft() {\n                this._move(\"left\");\n            }\n        },\n        {\n            key: \"moveRight\",\n            value: function moveRight() {\n                this._move(\"right\");\n            }\n        },\n        {\n            key: \"moveUp\",\n            value: function moveUp() {\n                this._move(\"up\");\n            }\n        },\n        {\n            key: \"moveDown\",\n            value: function moveDown() {\n                this._move(\"down\");\n            }\n        },\n        {\n            key: \"_emptyBoard\",\n            value: function _emptyBoard() {\n                var _this = this;\n                return Array.from({\n                    length: this.size\n                }, function() {\n                    return Array(_this.size).fill(0);\n                });\n            }\n        },\n        {\n            key: \"_isBoardEmpty\",\n            value: function _isBoardEmpty() {\n                return this._board.every(function(row) {\n                    return row.every(function(v) {\n                        return v === 0;\n                    });\n                });\n            }\n        },\n        {\n            key: \"_spawnRandomTile\",\n            value: function _spawnRandomTile() {\n                var empties = [];\n                for(var r1 = 0; r1 < this.size; r1++){\n                    for(var c1 = 0; c1 < this.size; c1++)if (this._board[r1][c1] === 0) empties.push([\n                        r1,\n                        c1\n                    ]);\n                }\n                if (!empties.length) return false;\n                var _empties_Math_floor = _sliced_to_array(empties[Math.floor(Math.random() * empties.length)], 2), r2 = _empties_Math_floor[0], c2 = _empties_Math_floor[1];\n                this._board[r2][c2] = Math.random() < 0.9 ? 2 : 4;\n                return true;\n            }\n        },\n        {\n            key: \"_move\",\n            value: function _move(direction) {\n                if (this._status !== \"playing\") return;\n                var prevSerialized = this._serialize(this._board);\n                var changed = false;\n                if (direction === \"left\") changed = this._moveLeftInternal();\n                else if (direction === \"right\") {\n                    this._reverseRows();\n                    changed = this._moveLeftInternal();\n                    this._reverseRows();\n                } else if (direction === \"up\") {\n                    this._transpose();\n                    changed = this._moveLeftInternal();\n                    this._transpose();\n                } else if (direction === \"down\") {\n                    this._transpose();\n                    this._reverseRows();\n                    changed = this._moveLeftInternal();\n                    this._reverseRows();\n                    this._transpose();\n                }\n                if (!changed || prevSerialized === this._serialize(this._board)) return;\n                this._spawnRandomTile();\n                this._recomputeStatus();\n            }\n        },\n        {\n            key: \"_serialize\",\n            value: function _serialize(board) {\n                return board.flat().join(\",\");\n            }\n        },\n        {\n            key: \"_reverseRows\",\n            value: function _reverseRows() {\n                for(var r1 = 0; r1 < this.size; r1++)this._board[r1].reverse();\n            }\n        },\n        {\n            key: \"_transpose\",\n            value: function _transpose() {\n                var n = this.size;\n                for(var r1 = 0; r1 < n; r1++)for(var c1 = r1 + 1; c1 < n; c1++){\n                    var t = this._board[r1][c1];\n                    this._board[r1][c1] = this._board[c1][r1];\n                    this._board[c1][r1] = t;\n                }\n            }\n        },\n        {\n            key: \"_moveLeftInternal\",\n            value: function _moveLeftInternal() {\n                var _this = this, _loop = function(r1) {\n                    var rowArr = _this._board[r1].slice();\n                    var compressed = rowArr.filter(function(v) {\n                        return v !== 0;\n                    });\n                    var merged = [];\n                    for(var i = 0; i < compressed.length; i++)if (compressed[i] === compressed[i + 1]) {\n                        var v = compressed[i] * 2;\n                        merged.push(v);\n                        _this._score += v;\n                        i++;\n                    } else merged.push(compressed[i]);\n                    while(merged.length < _this.size)merged.push(0);\n                    for(var c1 = 0; c1 < _this.size; c1++){\n                        if (_this._board[r1][c1] !== merged[c1]) anyChange = true;\n                        _this._board[r1][c1] = merged[c1];\n                    }\n                };\n                var anyChange = false;\n                for(var r1 = 0; r1 < this.size; r1++)_loop(r1);\n                return anyChange;\n            }\n        },\n        {\n            key: \"_has2048\",\n            value: function _has2048() {\n                return this._board.some(function(r1) {\n                    return r1.some(function(v) {\n                        return v === 2048;\n                    });\n                });\n            }\n        },\n        {\n            key: \"_canMove\",\n            value: function _canMove() {\n                if (this._board.some(function(r1) {\n                    return r1.some(function(v) {\n                        return v === 0;\n                    });\n                })) return true;\n                var n = this.size;\n                for(var r1 = 0; r1 < n; r1++)for(var c1 = 0; c1 < n; c1++){\n                    var v = this._board[r1][c1];\n                    if (c1 + 1 < n && v === this._board[r1][c1 + 1] || r1 + 1 < n && v === this._board[r1 + 1][c1]) return true;\n                }\n                return false;\n            }\n        },\n        {\n            key: \"_recomputeStatus\",\n            value: function _recomputeStatus() {\n                if (this._has2048()) {\n                    this._status = \"win\";\n                    return;\n                }\n                if (!this._canMove()) {\n                    this._status = \"lose\";\n                    return;\n                }\n                this._status = \"playing\";\n            }\n        }\n    ]);\n    return Game;\n}();\nif (typeof module !== \"undefined\" && module.exports) module.exports = Game;\nif (typeof window !== \"undefined\") window.Game = Game;\n\n//# sourceMappingURL=index.f31f53b1.js.map\n","'use strict';\n\nclass Game {\n  constructor(initialState) {\n    this.size = 4;\n\n    this._initial =\n      Array.isArray(initialState) && initialState.length === this.size\n        ? initialState.map((row) => row.slice())\n        : this._emptyBoard();\n\n    this._board = this._initial.map((row) => row.slice());\n    this._score = 0;\n    this._status = 'idle';\n  }\n\n  getState() {\n    return this._board.map((r) => r.slice());\n  }\n\n  getScore() {\n    return this._score;\n  }\n\n  getStatus() {\n    return this._status;\n  }\n\n  start() {\n    if (this._status !== 'idle') {\n      return;\n    }\n\n    if (this._isBoardEmpty()) {\n      this._spawnRandomTile();\n      this._spawnRandomTile();\n    }\n    this._status = 'playing';\n    this._recomputeStatus();\n  }\n\n  restart() {\n    this._board = this._initial.map((row) => row.slice());\n    this._score = 0;\n    this._status = 'idle';\n  }\n\n  moveLeft() {\n    this._move('left');\n  }\n  moveRight() {\n    this._move('right');\n  }\n  moveUp() {\n    this._move('up');\n  }\n  moveDown() {\n    this._move('down');\n  }\n\n  _emptyBoard() {\n    return Array.from({ length: this.size }, () => Array(this.size).fill(0));\n  }\n\n  _isBoardEmpty() {\n    return this._board.every((row) => row.every((v) => v === 0));\n  }\n\n  _spawnRandomTile() {\n    const empties = [];\n\n    for (let r1 = 0; r1 < this.size; r1++) {\n      for (let c1 = 0; c1 < this.size; c1++) {\n        if (this._board[r1][c1] === 0) {\n          empties.push([r1, c1]);\n        }\n      }\n    }\n\n    if (!empties.length) {\n      return false;\n    }\n\n    const [r2, c2] = empties[Math.floor(Math.random() * empties.length)];\n\n    this._board[r2][c2] = Math.random() < 0.9 ? 2 : 4;\n\n    return true;\n  }\n\n  _move(direction) {\n    if (this._status !== 'playing') {\n      return;\n    }\n\n    const prevSerialized = this._serialize(this._board);\n    let changed = false;\n\n    if (direction === 'left') {\n      changed = this._moveLeftInternal();\n    } else if (direction === 'right') {\n      this._reverseRows();\n      changed = this._moveLeftInternal();\n      this._reverseRows();\n    } else if (direction === 'up') {\n      this._transpose();\n      changed = this._moveLeftInternal();\n      this._transpose();\n    } else if (direction === 'down') {\n      this._transpose();\n      this._reverseRows();\n      changed = this._moveLeftInternal();\n      this._reverseRows();\n      this._transpose();\n    }\n\n    if (!changed || prevSerialized === this._serialize(this._board)) {\n      return;\n    }\n\n    this._spawnRandomTile();\n    this._recomputeStatus();\n  }\n\n  _serialize(board) {\n    return board.flat().join(',');\n  }\n\n  _reverseRows() {\n    for (let r1 = 0; r1 < this.size; r1++) {\n      this._board[r1].reverse();\n    }\n  }\n\n  _transpose() {\n    const n = this.size;\n\n    for (let r1 = 0; r1 < n; r1++) {\n      for (let c1 = r1 + 1; c1 < n; c1++) {\n        const t = this._board[r1][c1];\n\n        this._board[r1][c1] = this._board[c1][r1];\n        this._board[c1][r1] = t;\n      }\n    }\n  }\n\n  _moveLeftInternal() {\n    let anyChange = false;\n\n    for (let r1 = 0; r1 < this.size; r1++) {\n      const rowArr = this._board[r1].slice();\n      const compressed = rowArr.filter((v) => v !== 0);\n\n      const merged = [];\n\n      for (let i = 0; i < compressed.length; i++) {\n        if (compressed[i] === compressed[i + 1]) {\n          const v = compressed[i] * 2;\n\n          merged.push(v);\n          this._score += v;\n          i++;\n        } else {\n          merged.push(compressed[i]);\n        }\n      }\n\n      while (merged.length < this.size) {\n        merged.push(0);\n      }\n\n      for (let c1 = 0; c1 < this.size; c1++) {\n        if (this._board[r1][c1] !== merged[c1]) {\n          anyChange = true;\n        }\n        this._board[r1][c1] = merged[c1];\n      }\n    }\n\n    return anyChange;\n  }\n\n  _has2048() {\n    return this._board.some((r1) => r1.some((v) => v === 2048));\n  }\n\n  _canMove() {\n    if (this._board.some((r1) => r1.some((v) => v === 0))) {\n      return true;\n    }\n\n    const n = this.size;\n\n    for (let r1 = 0; r1 < n; r1++) {\n      for (let c1 = 0; c1 < n; c1++) {\n        const v = this._board[r1][c1];\n\n        if (\n          (c1 + 1 < n && v === this._board[r1][c1 + 1]) ||\n          (r1 + 1 < n && v === this._board[r1 + 1][c1])\n        ) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  _recomputeStatus() {\n    if (this._has2048()) {\n      this._status = 'win';\n\n      return;\n    }\n\n    if (!this._canMove()) {\n      this._status = 'lose';\n\n      return;\n    }\n    this._status = 'playing';\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = Game;\n}\n\nif (typeof window !== 'undefined') {\n  window.Game = Game;\n}\n"],"names":["_array_like_to_array","arr","len","length","i","arr2","Array","Game","protoProps","initialState","_class_call_check","instance","Constructor","TypeError","size","_initial","isArray","map","row","slice","_emptyBoard","_board","_score","_status","key","value","r","_isBoardEmpty","_spawnRandomTile","_recomputeStatus","_move","_this","from","fill","every","v","empties","r1","c1","push","_empties_Math_floor","_array_with_holes","Math","floor","random","_iterable_to_array_limit","_s","_e","_i","Symbol","iterator","_arr","_n","_d","call","next","done","err","_unsupported_iterable_to_array","o","minLen","n","Object","prototype","toString","constructor","name","test","_non_iterable_rest","r2","c2","direction","prevSerialized","_serialize","changed","_moveLeftInternal","_reverseRows","_transpose","board","flat","join","reverse","t","anyChange","_loop","compressed","rowArr","filter","merged","some","_has2048","_canMove","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","module","exports","window"],"version":3,"file":"index.f31f53b1.js.map"}